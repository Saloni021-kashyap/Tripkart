<% layout("/layouts/boilerplate") %>

<h2 class="fw-bold text-center">Explore</h2>
<p class="explore-tagline text-center">
  Journeys of Faith Experiences of Adventure.
</p>

<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 g-4">

  <% for (let listing of allListings) { %>
    <div class="col">
      <div class="card listing-card h-100 shadow-sm">

        <!-- IMAGE -->
        <a href="/listings/<%= listing._id %>" class="listing-img-wrapper">
          <% if (listing.images && listing.images.length > 0) { %>
            <img 
            src="<%= listing.images?.[0]?.url || '/images/default.jpg' %>" 
            class="card-img-top"
              >

          <% } else if (listing.image) { %>
            <img
              src="<%= listing.image %>"
              alt="listing image"
              class="listing-img"
            />
          <% } else { %>
            <img
              src="/images/default.jpg"
              alt="default image"
              class="listing-img"
            />
          <% } %>
        </a>

        <!-- CARD BODY -->
        <div class="card-body d-flex flex-column">

          <h5 class="card-title fw-bold mb-1">
            <%= listing.title %>
          </h5>

          <p class="text-muted mb-2 small">
            <i class="bi bi-geo-alt-fill"></i> <%= listing.destination %>
          </p>

          <span class="badge rounded-pill bg-info text-dark align-self-start mb-2">
            <i class="bi bi-truck-front-fill"></i> <%= listing.travelMode %>
          </span>

          <span class="badge bg-success align-self-start mb-2">
            Seats Left: <%= listing.availableSeats %> / <%= listing.totalSeats %>
          </span>

          <p class="fw-semibold fs-5 mt-auto mb-2">
            â‚¹ <%= listing.price %>
          </p>

          <a
            href="/listings/<%= listing._id %>"
            class="btn btn-primary btn-sm w-100"
          >
            View Details
          </a>

        </div>
      </div>
    </div>
  <% } %>

</div>
